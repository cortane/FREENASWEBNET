# FreeNAS WebService

---

## ğŸ“– æ¦‚è¦

**FreeNAS WebService** ã¯ Node.js è£½ã®è»½é‡ãƒ»é«˜æ©Ÿèƒ½ãªWebãƒ™ãƒ¼ã‚¹NASã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ç›´æ„Ÿçš„ãªWeb UIã§ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãƒ»å…±æœ‰ãŒå¯èƒ½ã§ã™ã€‚

---

## ğŸš€ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

### ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰
```bash
npm install -g freenaswebservice
```

### ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npm install freenaswebservice
```

### æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
git clone https://github.com/cortane/FREENASWEBNET.git
cd FREENASWEBNET
npm install
```

---

## ğŸ–¥ï¸ èµ·å‹•æ–¹æ³•

### ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œ
```bash
freenaswebservice
```

### ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œ
```bash
npx freenaswebservice
```

### æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œ
```bash
npm start
# ã¾ãŸã¯
node server.js
```

### ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹
- `http://localhost:3000` ã«ã‚¢ã‚¯ã‚»ã‚¹

---

## ğŸŒ Tailscale Funnelã§å¤–éƒ¨å…¬é–‹

### Tailscale Funnelã¨ã¯ï¼Ÿ
Tailscale Funnelã‚’ä½¿ã†ã¨ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±ã§å®‰å…¨ã«è‡ªå®…ã‚µãƒ¼ãƒãƒ¼ã¸ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

### ä½¿ã„æ–¹ï¼ˆä¾‹: Windowsï¼‰
1. Tailscaleã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€ãƒ­ã‚°ã‚¤ãƒ³
2. ã‚µãƒ¼ãƒãƒ¼ã‚’`0.0.0.0`ã§èµ·å‹•ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å¯¾å¿œæ¸ˆã¿ï¼‰
3. Funnelã‚’æœ‰åŠ¹åŒ–
   ```bash
   tailscale funnel 3000
   # ã¾ãŸã¯
   tailscale serve 3000
   ```
4. è¡¨ç¤ºã•ã‚ŒãŸURLï¼ˆä¾‹: `https://xxxx.ts.net/`ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹

#### æ³¨æ„ç‚¹
- Funnelæœ‰åŠ¹æ™‚ã¯HTTPSã§ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¾ã™
- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã‚„é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚è‡ªå‹•ã§ãƒ—ãƒ­ã‚­ã‚·ã•ã‚Œã¾ã™
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã€ä¸è¦æ™‚ã¯`tailscale funnel reset`ã§åœæ­¢æ¨å¥¨
- è©³ç´°: [Tailscaleå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://tailscale.com/kb/1247/funnel-serve-use-cases)

---

## ğŸ“¦ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å**: `freenaswebservice`
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
- **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**: MIT
- **Node.jsè¦ä»¶**: >=14.0.0
- **å¯¾å¿œOS**: Windows, Linux, macOS
- **å¯¾å¿œCPU**: x64, x86, arm64

---

## ğŸ› ï¸ ä¸»ãªæ©Ÿèƒ½

### ğŸ” èªè¨¼
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä»»æ„ï¼‰
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä»˜ã/ãªã—ãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼åè‡ªå‹•ã€ŒT-ã€ä»˜ä¸ï¼ˆã”è‡ªèº«ã®ãƒ‰ãƒ©ã‚¤ãƒ–å¤§æ–‡å­—ã‚’ä»˜ä¸ã—ã¦ãã ã•ã„ï¼‰
- è‡ªå‹•ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¦å¦åˆ¤å®š

### ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
- éšå±¤å‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€è¡¨ç¤º
- è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- ãƒ†ã‚­ã‚¹ãƒˆ/ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
- ãƒ‘ãƒ³ããšãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

### ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ 
- WebSocketã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´å³æ™‚é€šçŸ¥
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®æ¥ç¶šç®¡ç†

### ğŸ“Š ç›£è¦–ãƒ»ãƒ­ã‚°
- ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ï¼ˆIP/ç«¯æœ«/ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰2é€²æ•°ï¼‰
- ã‚µãƒ¼ãƒãƒ¼å¥å…¨æ€§ç›£è¦–ï¼ˆãƒ¡ãƒ¢ãƒª/CPU/ã‚¨ãƒ©ãƒ¼ç‡/æ¥ç¶šæ•°ï¼‰
- 30ç§’ã”ã¨ã®å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯
- è­¦å‘Šã‚·ã‚¹ãƒ†ãƒ ï¼ˆé–¾å€¤è¶…éæ™‚ï¼‰

### ğŸ¨ UI
- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ»ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
- ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ

---

## âš™ï¸ ã‚µãƒ¼ãƒãƒ¼è¨­å®šä¾‹
```js
const PORT = 3000;           // ãƒãƒ¼ãƒˆç•ªå·
const ROOT_DIR = "T:\\Users"; // ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆãŠä½¿ã„ã®ã‚¯ãƒ©ã‚¦ãƒ‰ç”¨HDDã®pathã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚ï¼‰
```

---

## ğŸ”Œ APIä¸€è¦§

### èªè¨¼API
- `POST /api/check-password` â€¦ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¦å¦åˆ¤å®š
- `POST /api/register` â€¦ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
- `POST /api/login` â€¦ ãƒ­ã‚°ã‚¤ãƒ³

### ãƒ•ã‚¡ã‚¤ãƒ«API
- `GET /api/files` â€¦ ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§å–å¾—
- `GET /api/file-content` â€¦ ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹å–å¾—ï¼ˆ10MBä»¥ä¸‹ï¼‰
- `POST /api/upload` â€¦ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆè¤‡æ•°å¯¾å¿œï¼‰
- `GET /api/download` â€¦ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- `POST /api/mkdir` â€¦ ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ

### WebSocket
- æ¥ç¶š: `ws://localhost:3000/?username=T-username`
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: `{ type: "update", filename, eventType }`

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆä¾‹
```
FREENASWEBNET/
â”œâ”€â”€ server.js              # ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ index.html             # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UI
â”œâ”€â”€ install.js             # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ package.json           # ä¾å­˜é–¢ä¿‚å®šç¾©
â”œâ”€â”€ README.md              # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ LICENSE                # ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
â”œâ”€â”€ .gitignore             # Gité™¤å¤–è¨­å®š
â”œâ”€â”€ access.log             # ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°
â”œâ”€â”€ server.log             # ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°
â””â”€â”€ FreeNasWebService.ico  # ãƒ•ã‚¡ãƒ“ã‚³ãƒ³
ï¼ˆå¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¾‹ï¼šT:\\Users\\ï¼‰ # â€»ã“ã®ãƒ‘ã‚¹ã¯ãƒªãƒã‚¸ãƒˆãƒªå¤–éƒ¨ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰ç”¨HDDã‚„NASä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆ
T:(å¤–éƒ¨è¨˜æ†¶å®¹é‡è£…ç½®path)
    â”œâ”€â”€ T-ï¼ˆusernameï¼‰/
    â”‚   â””â”€â”€ UPS/
    â”‚       â””â”€â”€ Password.txt(ã“ã®ä¸­ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¨˜å…¥ã•ã‚Œã‚‹ã€â€»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒãªã„å ´åˆã¯UPSãƒ•ã‚©ãƒ«ãƒ€è‡ªä½“ãŒç”Ÿæˆã•ã‚Œãªã„ã€‚)
    â”œâ”€â”€ T-user1/
    â””â”€â”€ T-user2/
```

> **æ³¨è¨˜:**  
> `T:\Users\`ã¯æœ¬ãƒªãƒã‚¸ãƒˆãƒªå†…ã«ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚  
> ã‚µãƒ¼ãƒãƒ¼è¨­å®šï¼ˆROOT_DIRï¼‰ã§æŒ‡å®šã—ãŸã€Œã‚¯ãƒ©ã‚¦ãƒ‰ç”¨HDDã‚„NASä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆã€ã‚’æŒ‡ã—ã¾ã™ã€‚  
> å¿…è¦ã«å¿œã˜ã¦ã”è‡ªèº«ã®ç’°å¢ƒã«åˆã‚ã›ã¦ãƒ‘ã‚¹ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰2é€²æ•°å¤‰æ›ã«ã‚ˆã‚‹å¹³æ–‡ä¿è­·
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«é˜²æ­¢
- ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹è¡¨ç¤ºã¯10MBä»¥ä¸‹ã®ã¿
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- å…¨ã‚¢ã‚¯ã‚»ã‚¹è©³ç´°ãƒ­ã‚°

---

## ğŸ§‘â€ğŸ’» ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ãªã„
```bash
npm install
# ãƒãƒ¼ãƒˆç«¶åˆæ™‚
netstat -ano | findstr :3000
taskkill /PID <PID> /F
```

### ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„
```bash
# ã‚¯ãƒ©ã‚¦ãƒ‰å°‚ç”¨HDDã«ã€ŒUsersã€ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚‹ã‹ã”ç¢ºèªãã ã•ã„
Test-Path "T:\Users\T-username"
Get-Content "T:\Users\T-username\UPS\Password.txt"
```

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—
```bash
Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, FreeSpace
Get-Acl "T:\Users\T-username"
```

### ãƒ­ã‚°ç¢ºèª
```bash
Get-Content "access.log" -Tail 20
Get-Content "server.log" -Tail 20
```

---

## ğŸ“¦ ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- `ws` â€¦ WebSocketé€šä¿¡
- `formidable` â€¦ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

---

## ğŸš€ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ãƒ»é…å¸ƒ

### npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å…¬é–‹
```bash
npm pack
npm login
npm publish
npm version patch
npm publish
```

### ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npm install -g .
npm uninstall -g freenaswebservice
```

---

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
MIT License

---

**FreeNAS WebService** - ã‚·ãƒ³ãƒ—ãƒ«ã§å¼·åŠ›ãªWebãƒ™ãƒ¼ã‚¹NASã‚·ã‚¹ãƒ†ãƒ  ğŸš€